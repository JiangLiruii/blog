---
layout:       post
title:        "WPO(Web Performance Optimization) 中"
subtitle:     "无线通信"
date:         2018-12-15 12:00:00
author:       "Lorry"
header-mask:  0.3
header-img:   '/img/Fast-Moving-Light-Wallpaper.jpg'
catalog:      true
multilingual: false
tags:
    - web
---

现在无线连接无处不在, 用户也不会关心你的应用是不是"有线应用", 他们只希望不管在什么情况下, 访问相同的网址, 有相同的使用体验, 得到相同的结果, 甚至更好.

无线标准有相当多种:
WIFI, Bluetooth, MIMAX, ZigBee, NFC, LTE, HSPA, EV-DO, 甚至更早的3G, 卫星通信.如果要把每一个都搞懂然后去优化那是需要相当大的勇气, 好消息的大多数无线技术都是基于通用的规则, 相同的权衡因素, 性能指标以及约束条件, 只要把影响无线性能的基本原理搞清楚, 其他问题就迎刃而解了.

# 无线网络的类型
## 按照影响地理范围划分

|类型|范围|应用|标准|
|---|---|---|---|
|个人局域网(PAN Personal area network)|个人活动范围|替代有线传输|蓝牙, ZigBee, NFC|
|本地局域网(LAN, Local area network)|一栋建筑或一个校园|有线网络的无线扩展|IEEE 802.11(W-Fi)|
|城域网(MAN, Metropolitan area netw)|城市范围|无线内联网|IEEE 802.15(WiMAX)|
|广域网(WAN, Wide area network)|全球范围|无线网络|蜂窝(UMTS, LTE等)|

# 无线网络性能基础

每种类型的无线技术都有其自由的一套约束和限制, 但是无论哪种无线技术, 都有一个最大通道容量. 信道容量是最大的信息速率

![](/img/channel_capacity.svg)

- C 是信道荣祥, 单位为bits/s
- BW是可用带块, 单位为hz
- S是信号, N是噪声, 单位为W

## 带宽 BW
不像有线网络通过线缆将各个节点连接起来, 无线电是一种公用的机制 - **radio-wave** 无线电波, 更准确的将是电磁辐射. 收发双方都必须遵循一个使用频率. 比如802.11b 和 802.11g标准都是使用的2.4-2.5GHz频带.

 在美国, 这个过程是由FCC(Federal Communications Commission), 不同政府由不同规则, 所以有可能在不同国家由不一样的频率范围

![](/img/FCC_Frequency_Band.svg)

除开政治原因, 共享相同的频带能保证兼容的交互, 性能因素最重要的就是分配的频带范围. 在上述公式中信道总体比特率与分配的带宽成正比. 这就是最初802.11n相比于早期WIFI标准提升性能的方式.

最后值得注意的是不是所有的频段提供相同的性能, 越低的频率信号传输得越远, 并且覆盖更广的面积(macrocells-大蜂窝), 但是需要花费更多的大型天线还要由更多的竞争(接入的范围大). 

高频信号可以传输更多的数据, 但是传不远, 从而形成较小的覆盖范围(microcells-小蜂窝)并且需要更多的基础设施.

不同的频段对不同的应用来说价值也不一样, 对广播来说, 更需要低频, 而双向通信则需要高频, 提供更大的带宽, 竞争也会少一些.

### 分频历史

这个比较有意思, 提出来说一下, 在1912年前, **任何人**都可以使用她想要的任何频段. 1912年, 美国通过了射频法案, 规范射频光谱的使用, 而设立该法案的初心是因为泰坦尼克的沉没--如果有专用的紧急信道, 其他更多的船只就可以收到信号前去营救, 这样就不会死那么多人了.1934年FCC出台通信法案并负责分配频谱.

1947年, **ISM(industrial, scientific, medical)频带**是第一个被国际通信委员会建立并在各国有保留频段. 2.4-2.5GHz(100MHz) 和 5.725-5.825GHz(159MHz)带宽, 这也是现在用的无线通信(WiFi)的频段之一. 这些频段也被视为"没有证书的频段", 可以允许任何人允许在无线网上, 不管是因为商业还是私有用途. 在这些频段和使用的硬件遵从具体的技术标准,比如 transmit power, 传输功率

最后, 因为不断增长的无线通信需求, 政府开始举办频谱拍卖, 售出证书以允许在特定频段上传输信号. 2008年, 698-806MHz在美国拍出了**196亿**美金.足以证明带宽的稀有和珍贵. 这将继续成为一个高竞争的领域.

### 信号功率
除开带宽之外, 次要因素就是收端和发端的信号功率大小. 也成为信噪比( SNR S/N ratio), 值越大,信号就越强.
通常来说所有的无线信号是共用媒质的, 比如空气, 这也就意味着会被其他设备产生信号干涉, 举例:
微波炉工作在2.5GHz, 笔记本也用这个频段使用 WiFi, 就会发生跨标准感谢. 如果手机其他 WiFi 设备, 比如邻居家的WiFi,甚至连接同一个 WiFi 的同事的电脑, 也能对你的传输产生干涉.

最好的情况是, 你自己用自己的某个特殊评断, 没有任何噪声和干扰, 但那几乎是不可能的. 只能保证需要的数据在即使有干扰的情况下也能被收到, 可以尝试
- 尽可能提高传输功率, 增大 signal 的值
- 降低传输距离

还有一个因素是路径损耗, 距离越长, 信号量越少的现象. 这个现象没法避免, 具体可以参见 [维基百科](https://en.wikipedia.org/wiki/Path_loss)

![](/img/Optimize/SNR.svg)

上图展示了两个重要的问题

1. 远近问题
    1. 接受者获取强信号的条件
    2. 接受者不可能从比1条件更弱的信号中获取信息有效的区分出信息
2. 蜂窝呼吸
    1. 覆盖范围的条件, 或者说信号传递的距离
    2. 会基于噪音和干扰强度不停地扩张或收缩

### 数模转换

可用的带宽和信噪比是影响无线信道容量的主要的两个物理因素. 但是信号量算法的编码也能有重大的影响. 这里涉及到数模转换 - 把数字信号的0和1放到模拟信号(射频信号)上.

- 收发两端可以处理1000个脉冲每秒(1000 baud)--波特率
- 每个传输元代表不同的位序列, 由选择的字母表决定比如 2-bit 字母表为: 00, 01, 10, 11
- 通道的比特率是1000 baud * 2bits = 2000bits/s

数模转换的算法取决于可用的技术, 收发双端的计算功率和信噪比. 越高等级的转换表可以降低干扰, 但是也会提高成本.

### 衡量现实世界的无线性能

所有的射频通信基于:
- 共享通信媒质
- 受限与使用具体的带宽频率范围
- 受限于使用具体的传输功率比
- 受限于不停变化的背景噪音和干扰
- 受限于无线技术类型
- 受限于设备, 成型因素( form factor), 功率等

所有的无线技术都有建议的峰值, 或数据的最大值. 举例: 802.11g 标准是 54Mbit/s, 802.11n 标准是600Mbit/s, 类似的, 一些移动运营商选出 LTE 的吞吐量可达100+Mbit/s, 但是, 这些都是在最理想的情况下的数据. 啥事最理想的条件?
- 分配的带宽的最大值
- 专享带宽
- 最小化甚至没有背景噪音
- 最高的数模转换吞吐量
- 多个射频流( MIMO )

所以这些因素就可以影响无线网络性能了:
- 收发端举例
- 当前位置的背景噪声
- 相同网络下不同用户干扰
- 附近不同网络干扰
- 收发双端的可用传输性能
- 处理性能和选择的模数转换类型

上述的影响性能因素只考虑了吞吐量, 还没有考虑延迟, 因不同的无线方案而不同, 之后会详细说明延迟的



